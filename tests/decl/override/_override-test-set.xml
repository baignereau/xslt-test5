<?xml version="1.0" encoding="UTF-8"?>
<test-set xmlns:xs="http://www.w3.org/2001/XMLSchema"
          xmlns="http://www.w3.org/2012/10/xslt-test-catalog"
          name="override">
   <description>Tests xsl:override in XSLT 3.0</description>
   
   <environment name="override-env-001">
      <package file="override-base-001.xsl" role="secondary" uri="http://www.w3.org/xslt30tests/override-base-001" package-version="1.0.0"/>
   </environment>
   
   <environment name="override-env-101">
      <package file="override-base-101.xsl" role="secondary" uri="http://www.w3.org/xslt30tests/override-base-101" package-version="1.0.0"/>
   </environment>
   
   <environment name="override-env-201">
      <package file="override-base-201.xsl" role="secondary" uri="http://www.w3.org/xslt30tests/override-base-201" package-version="1.0.0"/>
   </environment>
   
   <environment name="override-env-301">
      <package file="override-base-301.xsl" role="secondary" uri="http://www.w3.org/xslt30tests/override-base-301" package-version="1.0.0"/>
   </environment>
   
   <environment name="override-env-901">
      <package file="override-base-901.xsl" role="secondary" uri="http://www.w3.org/xslt30tests/override-base-901" package-version="1.0.0"/>
   </environment>

   <dependencies>
      <spec value="XSLT30+"/>
   </dependencies>

   <test-case name="override-001">
      <description>Successful override of a function</description>
      <created by="Michael Kay" on="2013-07-08"/>
      <modified by="Michael Kay" on="2014-08-22" change="no xsl:stylesheet child of xsl:package"/>
      <environment ref="override-env-001"/>
      <test>
         <package file="override-001.xsl" role="principal"/>
         <initial-template name="main"/>
      </test>
      <result>
         <assert>/ok</assert>
      </result>
   </test-case>
   
   <test-case name="override-002">
      <description>Successful use of override of a function defined in a library package</description>
      <created by="O'Neil Delpratt" on="2013-07-17"/>
      <modified by="Michael Kay" on="2014-08-22" change="no xsl:stylesheet child of xsl:package"/>
      <environment ref="override-env-001"/>
      <test>
         <package file="override-002.xsl" role="principal"/>
         <initial-template name="main"/>
      </test>
      <result>
         <assert>/ok</assert>
      </result>
   </test-case>
   
   <test-case name="override-003">
      <description>Unsuccessful use of override of a function defined in a library package. Parameter types are different</description>
      <created by="O'Neil Delpratt" on="2013-07-17"/>
      <modified by="Michael Kay" on="2014-08-22" change="no xsl:stylesheet child of xsl:package"/>
      <environment ref="override-env-001"/>
      <test>
         <package file="override-003.xsl" role="principal"/>
         <initial-template name="main"/>
      </test>
      <result>
         <error code="XTSE3070"/>
      </result>
   </test-case>
   
   <test-case name="override-004">
      <description>Unsuccessful use of override of a function as it is not defined in a library package.</description>
      <created by="O'Neil Delpratt" on="2013-07-17"/>
      <modified by="Michael Kay" on="2014-08-22" change="no xsl:stylesheet child of xsl:package"/>
      <environment ref="override-env-001"/>
      <test>
         <package file="override-004.xsl" role="principal"/>
         <initial-template name="main"/>
      </test>
      <result>
         <error code="XTSE3058"/>
      </result>
   </test-case>
   
   <test-case name="override-005">
      <description>Disallow text as a child of xsl:override.</description>
      <created by="Michael Kay" on="2013-07-19"/>
      <modified by="Michael Kay" on="2014-08-22" change="no xsl:stylesheet child of xsl:package"/>
      <environment ref="override-env-001"/>
      <test>
         <package file="override-005.xsl" role="principal"/>
         <initial-template name="main"/>
      </test>
      <result>
         <error code="XTSE0010"/>
      </result>
   </test-case>  
   
   <test-case name="override-006">
      <description>Disallow LRE as a child of xsl:override.</description>
      <created by="Michael Kay" on="2013-07-19"/>
      <modified by="Michael Kay" on="2014-08-22" change="no xsl:stylesheet child of xsl:package"/>
      <environment ref="override-env-001"/>
      <test>
         <package file="override-006.xsl" role="principal"/>
         <initial-template name="main"/>
      </test>
      <result>
         <error code="XTSE0010"/>
      </result>
   </test-case> 
   
   <test-case name="override-007">
      <description>Disallow xsl:override as a child of xsl:override.</description>
      <created by="Michael Kay" on="2013-07-19"/>
      <modified by="Michael Kay" on="2014-08-22" change="no xsl:stylesheet child of xsl:package"/>
      <environment ref="override-env-001"/>
      <test>
         <package file="override-007.xsl" role="principal"/>
         <initial-template name="main"/>
      </test>
      <result>
         <error code="XTSE0010"/>
      </result>
   </test-case>
   
   <test-case name="override-008">
      <description>Empty xsl:override is allowed.</description>
      <created by="Michael Kay" on="2013-07-19"/>
      <modified by="Michael Kay" on="2014-08-22" change="no xsl:stylesheet child of xsl:package"/>
      <environment ref="override-env-001"/>
      <test>
         <package file="override-008.xsl" role="principal"/>
         <initial-template name="main"/>
      </test>
      <result>
         <assert>/out</assert>
      </result>
   </test-case>
   
   <test-case name="override-009">
      <description>Overridden function called from within a stylesheet function</description>
      <created by="Michael Kay" on="2013-10-17"/>
      <modified by="Michael Kay" on="2014-08-22" change="no xsl:stylesheet child of xsl:package"/>
      <environment ref="override-env-001"/>
      <test>
         <package file="override-009.xsl" role="principal"/>
         <initial-template name="main"/>
      </test>
      <result>
         <assert>/ok</assert>
      </result>
   </test-case>
   
   <test-case name="override-010">
      <description>Overridden function called from within a global variable initializer</description>
      <created by="Michael Kay" on="2013-10-17"/>
      <modified by="Michael Kay" on="2014-08-22" change="no xsl:stylesheet child of xsl:package"/>
      <environment ref="override-env-001"/>
      <test>
         <package file="override-010.xsl" role="principal"/>
         <initial-template name="main"/>
      </test>
      <result>
         <assert>/ok</assert>
      </result>
   </test-case>
   
   <test-case name="override-011">
      <description>Overridden function called from within a template rule</description>
      <created by="Michael Kay" on="2013-10-17"/>
      <modified by="Michael Kay" on="2014-08-22" change="no xsl:stylesheet child of xsl:package"/>
      <environment ref="override-env-001"/>
      <test>
         <package file="override-011.xsl" role="principal"/>
         <initial-template name="main"/>
      </test>
      <result>
         <assert>/ok</assert>
      </result>
   </test-case>
   
   <test-case name="override-012">
      <description>Overridden function called from within a global variable in used package</description>
      <created by="Michael Kay" on="2013-10-17"/>
      <modified by="Michael Kay" on="2014-08-22" change="no xsl:stylesheet child of xsl:package"/>
      <environment ref="override-env-001"/>
      <test>
         <package file="override-012.xsl" role="principal"/>
         <initial-template name="main"/>
      </test>
      <result>
         <assert>/ok</assert>
      </result>
   </test-case>
   
   <test-case name="override-013">
      <description>Overridden function called via function reference in used package</description>
      <created by="Michael Kay" on="2015-02-28"/>
      <environment ref="override-env-001"/>
      <test>
         <package file="override-013.xsl" role="principal"/>
         <initial-template name="main"/>
      </test>
      <result>
         <assert>/ok</assert>
      </result>
   </test-case>
   
   <test-case name="override-014">
      <description>Private function called via function reference in used package</description>
      <created by="Michael Kay" on="2015-02-28"/>
      <environment ref="override-env-001"/>
      <test>
         <package file="override-014.xsl" role="principal"/>
         <initial-template name="main"/>
      </test>
      <result>
         <assert>/ok</assert>
      </result>
   </test-case>
   
   <test-case name="override-015">
      <description>Partial function application of an overridden function</description>
      <!-- Currently (2015-02-28) failing in Saxon because we're binding statically to the target function -->
      <created by="Michael Kay" on="2015-02-28"/>
      <environment ref="override-env-001"/>
      <test>
         <package file="override-015.xsl" role="principal"/>
         <initial-template name="main"/>
      </test>
      <result>
         <assert>/ok</assert>
      </result>
   </test-case>
   
   <test-case name="override-016">
      <description>A function call using xsl:original</description>
      <created by="Michael Kay" on="2015-03-01"/>
      <environment ref="override-env-001"/>
      <test>
         <package file="override-016.xsl" role="principal"/>
         <initial-template name="main"/>
      </test>
      <result>
         <assert>/ok</assert>
      </result>
   </test-case>
   
   <test-case name="override-017">
      <description>A named function reference using xsl:original</description>
      <created by="Michael Kay" on="2015-03-01"/>
      <environment ref="override-env-001"/>
      <test>
         <package file="override-017.xsl" role="principal"/>
         <initial-template name="main"/>
      </test>
      <result>
         <assert>/ok</assert>
      </result>
   </test-case>
   
   <test-case name="override-018">
      <description>Partial function application using xsl:original</description>
      <created by="Michael Kay" on="2015-03-01"/>
      <environment ref="override-env-001"/>
      <test>
         <package file="override-018.xsl" role="principal"/>
         <initial-template name="main"/>
      </test>
      <result>
         <assert>/ok</assert>
      </result>
   </test-case>
   
   <test-case name="override-101">
      <description>Successful override of a named template, when called from overriding package</description>
      <created by="Michael Kay" on="2013-07-31"/>
      <modified by="Michael Kay" on="2014-08-22" change="no xsl:stylesheet child of xsl:package"/>
      <environment ref="override-env-101"/>
      <test>
         <package file="override-101.xsl" role="principal"/>
         <initial-template name="main"/>
      </test>
      <result>
         <assert>/out = '*xxxxx*'</assert>
      </result>
   </test-case>  
   
   <test-case name="override-102">
      <description>Successful override of a named template, when called from base package</description>
      <created by="Michael Kay" on="2013-07-31"/>
      <modified by="Michael Kay" on="2014-08-22" change="no xsl:stylesheet child of xsl:package"/>
      <environment ref="override-env-101"/>
      <test>
         <package file="override-102.xsl" role="principal"/>
         <initial-template name="main"/>
      </test>
      <result>
         <assert>/out = '*xxxxx*'</assert>
      </result>
   </test-case>   
   
   <test-case name="override-103">
      <description>Cannot call an abstract template</description>
      <created by="Michael Kay" on="2013-07-31"/>
      <modified by="Michael Kay" on="2014-08-22" change="no xsl:stylesheet child of xsl:package"/>
      <environment ref="override-env-101"/>
      <test>
         <package file="override-103.xsl" role="principal"/>
         <initial-template name="main"/>
      </test>
      <result>
         <error code="XTSE3080"/>
      </result>
   </test-case>
   
   <test-case name="override-104">
      <description>Illegal template override, parameter types do not match</description>
      <created by="Michael Kay" on="2014-10-10"/>
      <environment ref="override-env-101"/>
      <test>
         <package file="override-104.xsl" role="principal"/>
         <initial-template name="main"/>
      </test>
      <result>
         <error code="XTSE3080"/>
      </result>
   </test-case>
   
   <test-case name="override-105">
      <description>Illegal template override, context item types do not match</description>
      <created by="Michael Kay" on="2014-10-10"/>
      <environment ref="override-env-101"/>
      <test>
         <package file="override-105.xsl" role="principal"/>
         <initial-template name="main"/>
      </test>
      <result>
         <error code="XTSE3080"/>
      </result>
   </test-case>
   
   <test-case name="override-106">
      <description>Illegal template override, context item use does not match</description>
      <created by="Michael Kay" on="2014-10-10"/>
      <modified by="Michael Kay" on="2015-01-26" change="keyword change: prohibited -> absent"/>
      <environment ref="override-env-101"/>
      <test>
         <package file="override-106.xsl" role="principal"/>
         <initial-template name="main"/>
      </test>
      <result>
         <error code="XTSE3080"/>
      </result>
   </test-case>
   
   <test-case name="override-107">
      <description>A named template calling xsl:original</description>
      <created by="Michael Kay" on="2015-03-01"/>
      <environment ref="override-env-101"/>
      <test>
         <package file="override-107.xsl" role="principal"/>
         <initial-template name="main"/>
      </test>
      <result>
         <assert>/out = '*xxxxx*'</assert>
      </result>
   </test-case>  

   <test-case name="override-201">
      <description>Successful override of a public global variable</description>
      <created by="Michael Kay" on="2013-10-18"/>
      <modified by="Michael Kay" on="2014-08-22" change="no xsl:stylesheet child of xsl:package"/>
      <environment ref="override-env-201"/>
      <test>
         <package file="override-201.xsl" role="principal"/>
         <initial-template name="main"/>
      </test>
      <result>
         <assert>/ok</assert>
      </result>
   </test-case>
   
   <test-case name="override-202">
      <description>Reference from private variable to overridden public variable</description>
      <created by="Michael Kay" on="2013-10-18"/>
      <modified by="Michael Kay" on="2014-08-22" change="no xsl:stylesheet child of xsl:package"/>
      <environment ref="override-env-201"/>
      <test>
         <package file="override-202.xsl" role="principal"/>
         <initial-template name="main"/>
      </test>
      <result>
         <assert>/ok</assert>
      </result>
   </test-case>
   
   <test-case name="override-203">
      <description>An overridden public global variable using xsl:original</description>
      <created by="Michael Kay" on="2015-03-01"/>
      <environment ref="override-env-201"/>
      <test>
         <package file="override-203.xsl" role="principal"/>
         <initial-template name="main"/>
      </test>
      <result>
         <assert>/ok</assert>
      </result>
   </test-case>
   
   <test-case name="override-301">
      <description>Successful override of a public attribute-set</description>
      <created by="Michael Kay" on="2015-02-28"/>
      <environment ref="override-env-301"/>
      <test>
         <package file="override-301.xsl" role="principal"/>
         <initial-template name="main"/>
      </test>
      <result>
         <assert-xml><![CDATA[<out><x pub1="pub1o" pub2="pub2o"/><y abs1="abs1o" abs2="abs2o"/><z final1="final1"/></out>]]></assert-xml>
      </result>
   </test-case>
   
   <test-case name="override-302">
      <description>Successful override of a public attribute-set with use-attribute-sets="xsl:original"</description>
      <created by="Michael Kay" on="2015-02-28"/>
      <environment ref="override-env-301"/>
      <test>
         <package file="override-302.xsl" role="principal"/>
         <initial-template name="main"/>
      </test>
      <result>
         <assert-xml><![CDATA[<out><x base1="base1"
      priv1="priv1"
      pub1="pub1o"
      pub2="pub2"
      pub3="pub3o"/><y abs1="abs1o" abs2="abs2o"/><z final1="final1"/></out>]]></assert-xml>
      </result>
   </test-case>
   
   <test-case name="override-303">
      <description>Override of a public attribute-set creates a circularity</description>
      <created by="Michael Kay" on="2015-02-28"/>
      <environment ref="override-env-301"/>
      <test>
         <package file="override-303.xsl" role="principal"/>
         <initial-template name="main"/>
      </test>
      <result>
         <!--<error code="XXXX9999"/>-->
         <assert-xml><![CDATA[<err/>]]></assert-xml>
      </result>
   </test-case>
   
   <test-case name="override-304">
      <description>Attempt to override a private attribute-set</description>
      <created by="Michael Kay" on="2015-02-28"/>
      <environment ref="override-env-301"/>
      <test>
         <package file="override-304.xsl" role="principal"/>
         <initial-template name="main"/>
      </test>
      <result>
         <error code="XTSE3060"/>
      </result>
   </test-case>
   
   <test-case name="override-305">
      <description>Two private attribute sets with the same name in different packages</description>
      <created by="Michael Kay" on="2015-02-28"/>
      <environment ref="override-env-301"/>
      <test>
         <package file="override-305.xsl" role="principal"/>
         <initial-template name="main"/>
      </test>
      <result>
         <assert-xml><![CDATA[<out><x pub1="pub1" pub2="pub2"/><y priv8="priv8" priv9="priv9"/></out>]]></assert-xml>
      </result>
   </test-case>
   
   
   <test-case name="override-901">
      <description>Cannot override a key</description>
      <created by="Michael Kay" on="2015-03-01"/>
      <environment ref="override-env-901"/>
      <test>
         <package file="override-901.xsl" role="principal"/>
         <initial-template name="main"/>
      </test>
      <result>
         <error code="XTSE0010"/>
      </result>
   </test-case>
   
   <test-case name="override-902">
      <description>Cannot override an accumulator</description>
      <created by="Michael Kay" on="2015-03-01"/>
      <environment ref="override-env-901"/>
      <test>
         <package file="override-902.xsl" role="principal"/>
         <initial-template name="main"/>
      </test>
      <result>
         <error code="XTSE0010"/>
      </result>
   </test-case>
   
   <test-case name="override-903">
      <description>Cannot override a decimal format</description>
      <created by="Michael Kay" on="2015-03-01"/>
      <environment ref="override-env-901"/>
      <test>
         <package file="override-903.xsl" role="principal"/>
         <initial-template name="main"/>
      </test>
      <result>
         <error code="XTSE0010"/>
      </result>
   </test-case>
   
   <test-case name="override-904">
      <description>Keys in different packages can have the same name</description>
      <created by="Michael Kay" on="2015-03-01"/>
      <environment ref="override-env-901"/>
      <test>
         <package file="override-904.xsl" role="principal"/>
         <initial-template name="main"/>
      </test>
      <result>
         <assert-xml><![CDATA[<out><a><x>y</x></a><b><e>x</e></b></out>]]></assert-xml>
      </result>
   </test-case>
   
   <test-case name="override-905">
      <description>Accumulators in different packages can have the same name</description>
      <created by="Michael Kay" on="2015-03-01"/>
      <environment ref="override-env-901"/>
      <test>
         <package file="override-905.xsl" role="principal"/>
         <initial-template name="main"/>
      </test>
      <result>
         <assert-xml><![CDATA[<out><a>-3</a><b>3</b></out>]]></assert-xml>
      </result>
   </test-case>
   
   <test-case name="override-906">
      <description>Decimal formats in different packages can have the same name</description>
      <created by="Michael Kay" on="2015-03-01"/>
      <environment ref="override-env-901"/>
      <test>
         <package file="override-906.xsl" role="principal"/>
         <initial-template name="main"/>
      </test>
      <result>
         <assert-xml><![CDATA[<out><a>123!456:78</a><b>123.456,78</b></out>]]></assert-xml>
      </result>
   </test-case>
   
      
  


</test-set>
