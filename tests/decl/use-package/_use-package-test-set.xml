<?xml version="1.0" encoding="UTF-8"?>
<test-set xmlns:xs="http://www.w3.org/2001/XMLSchema"
          xmlns="http://www.w3.org/2012/10/xslt-test-catalog"
          name="use-package">
   <description>Tests xsl:use-package in XSLT 3.0</description>
   
   <environment name="use-package-env-001">
      <package file="use-package-base-001.xsl" role="secondary" uri="http://www.w3.org/xslt30tests/use-package-base-001" package-version="1.0.0"/>
   </environment>
   
   <environment name="use-package-env-002">
      <package file="use-package-base-002.xsl" role="secondary" uri="http://www.w3.org/xslt30tests/use-package-base-002" package-version="1.0.0"/>
   </environment>
   
   <environment name="use-package-env-003">
      <package file="use-package-base-003.xsl" role="secondary" uri="http://www.w3.org/xslt30tests/use-package-base-003" package-version="1.0.0"/>
   </environment>

   <dependencies>
      <spec value="XSLT30+"/>
   </dependencies>

   <test-case name="use-package-001">
      <description>Successful use of a public function defined in a library package</description>
      <created by="Michael Kay" on="2013-07-08"/>
      <environment ref="use-package-env-001"/>
      <test>
         <package file="use-package-001.xsl" role="principal"/>
         <initial-template name="main"/>
      </test>
      <result>
         <assert>/ok</assert>
      </result>
   </test-case>
   
   <test-case name="use-package-002">
      <description>Successful use of a final function defined in a library package</description>
      <created by="Michael Kay" on="2013-07-08"/>
      <environment ref="use-package-env-001"/>
      <test>
         <package file="use-package-002.xsl" role="principal"/>
         <initial-template name="main"/>
      </test>
      <result>
         <assert>/ok</assert>
      </result>
   </test-case>
   
   <test-case name="use-package-003">
      <description>Unsuccessful use of a private function defined in a library package</description>
      <created by="Michael Kay" on="2013-07-08"/>
      <environment ref="use-package-env-001"/>
      <test>
         <package file="use-package-003.xsl" role="principal"/>
         <initial-template name="main"/>
      </test>
      <result>
         <error code="XPST0017"/>
      </result>
   </test-case>
   
   <test-case name="use-package-004">
      <description>Successful use of a public variable defined in a library package</description>
      <created by="Michael Kay" on="2013-10-17"/>
      <environment ref="use-package-env-003"/>
      <test>
         <package file="use-package-004.xsl" role="principal"/>
         <initial-template name="main"/>
      </test>
      <result>
         <assert>/ok</assert>
      </result>
   </test-case>
   
   <test-case name="use-package-005">
      <description>Successful use of a final variable defined in a library package</description>
      <created by="Michael Kay" on="2013-10-17"/>
      <environment ref="use-package-env-003"/>
      <test>
         <package file="use-package-005.xsl" role="principal"/>
         <initial-template name="main"/>
      </test>
      <result>
         <assert>/ok</assert>
      </result>
   </test-case>
   
   <test-case name="use-package-006">
      <description>Unsuccessful use of a private variable defined in a library package</description>
      <created by="Michael Kay" on="2013-10-17"/>
      <environment ref="use-package-env-003"/>
      <test>
         <package file="use-package-006.xsl" role="principal"/>
         <initial-template name="main"/>
      </test>
      <result>
         <error code="XPST0008"/>
      </result>
   </test-case>
   
   <test-case name="use-package-101">
      <description>Decimal formats are local to a package</description>
      <created by="Michael Kay" on="2013-07-17"/>
      <environment ref="use-package-env-002"/>
      <test>
         <package file="use-package-101.xsl" role="principal"/>
         <initial-template name="main"/>
      </test>
      <result>
         <all-of>
           <assert>/out/@p = '1~234.5 1!234.5'</assert>
           <assert>/out/@q = '1^234.5 1$234.5'</assert>
         </all-of>
      </result>
   </test-case>
   
   <test-case name="use-package-102">
      <description>Keys are local to a package</description>
      <created by="Michael Kay" on="2013-07-17"/>
      <environment ref="use-package-env-002"/>
      <test>
         <package file="use-package-102.xsl" role="principal"/>
         <initial-template name="main"/>
      </test>
      <result>
         <all-of>
           <assert>/out/@p = 'one'</assert>
           <assert>/out/@q = 'three'</assert>
         </all-of>
      </result>
   </test-case>
   
   <test-case name="use-package-103">
      <description>Namespace aliases are local to a package</description>
      <created by="Michael Kay" on="2013-07-17"/>
      <environment ref="use-package-env-002"/>
      <test>
         <package file="use-package-103.xsl" role="principal"/>
         <initial-template name="main"/>
      </test>
      <result>
         <all-of>
           <assert>namespace-uri(/out/*:test[1]) = 'http://www.w3.org/xslt30tests/use-package-103'</assert>
           <assert>namespace-uri(/out/*:test[2]) = 'http://www.w3.org/xslt30tests/use-package-base-002'</assert>
         </all-of>
      </result>
   </test-case>
   
   <test-case name="use-package-104">
      <description>Decimal formats are local to a package</description>
      <created by="Michael Kay" on="2013-07-18"/>
      <environment ref="use-package-env-002"/>
      <test>
         <package file="use-package-104.xsl" role="principal"/>
         <initial-template name="main"/>
      </test>
      <result>
         <error code="FODF1280"/>
      </result>
   </test-case>
   
   <test-case name="use-package-105">
      <description>Keys are local to a package</description>
      <created by="Michael Kay" on="2013-07-18"/>
      <environment ref="use-package-env-002"/>
      <test>
         <package file="use-package-105.xsl" role="principal"/>
         <initial-template name="main"/>
      </test>
      <result>
         <error code="XTDE1260"/>
      </result>
   </test-case>
   
   <test-case name="use-package-106">
      <description>Character maps are local to a package</description>
      <created by="Michael Kay" on="2013-07-18"/>
      <environment ref="use-package-env-002"/>
      <test>
         <package file="use-package-106.xsl" role="principal"/>
         <initial-template name="main"/>
      </test>
      <result>
         <error code="XTSE1590"/>
      </result>
   </test-case>
   
   <test-case name="use-package-107">
      <description>The unnamed output format is local to a package</description>
      <created by="Michael Kay" on="2013-07-18"/>
      <environment ref="use-package-env-002"/>
      <test>
         <package file="use-package-107.xsl" role="principal"/>
         <initial-template name="main"/>
      </test>
      <result>
         <assert>/out = 'zzz'</assert>
      </result>
   </test-case>
   
   <test-case name="use-package-108">
      <description>The unnamed output format is local to a package</description>
      <created by="Michael Kay" on="2013-07-18"/>
      <environment ref="use-package-env-002"/>
      <test>
         <package file="use-package-108.xsl" role="principal"/>
         <initial-template name="main"/>
      </test>
      <result>
         <serialization-matches><![CDATA[<out xmlns:p="[^"]*">ZZZZZZ</out>]]></serialization-matches>
      </result>
   </test-case>

</test-set>
