<?xml version="1.0" encoding="UTF-8"?>
<test-set xmlns="http://www.w3.org/2012/10/xslt-test-catalog" xmlns:xs="http://www.w3.org/2001/XMLSchema" name="catalog">
   
   <description>Tests that the test catalog is valid</description>
   
   <environment name="catalog001">
      <source role="." file="../../../catalog.xml" validation="strict"/>
      <!-- Note: secondary source documents not listed. The list would only get out of date... -->
      <schema role="source-reference" file="../../../admin/catalog-schema.xsd" xsd-version="1.0"/>
      <schema role="secondary" file="../../../admin/xml.xsd" xsd-version="1.0"/>
   </environment>
   
   <environment name="catalog005">
      <source role="." file="../../../catalog.xml" validation="strict"/>
      <!-- Note: secondary source documents not listed. The list would only get out of date... -->
      <schema role="source-reference" file="../../../admin/catalog-schema.xsd" xsd-version="1.1"/>
      <schema role="secondary" file="../../../admin/xml.xsd" xsd-version="1.1"/>
      <schema role="source-reference" file="schema-for-xslt30.xsd" xsd-version="1.1"/>
   </environment>
   
   <dependencies>
      <feature value="schema_aware"/>
   </dependencies>

   <test-case name="catalog-001">
      <description>Test that the test catalog is valid with respect to its schema</description>
      <keywords>catalog-self-test schema-validity xsl:import-schema</keywords>
      <created by="Michael Kay" on="2012-11-07"/>
      <environment ref="catalog001"/>
      <dependencies>
         <spec value="XSLT30+"/>
      </dependencies>
      <test>
         <stylesheet file="catalog-001.xsl"/>
      </test>
      <result>
         <assert>/ok[not(*)]</assert>
      </result>
   </test-case>
   
   <test-case name="catalog-002">
      <description>Test set names in the master catalog must match those in the test sets themselves</description>
      <keywords>catalog-self-test master-catalog</keywords>
      <created by="Michael Kay" on="2012-11-07"/>
      <environment ref="catalog001"/>
      <dependencies>
         <spec value="XSLT20+"/>
      </dependencies>
      <test>
         <stylesheet file="catalog-002.xsl"/>
      </test>
      <result>
         <assert>not(/ok/mismatch)</assert>
      </result>
   </test-case>
   
   <test-case name="catalog-003">
      <description>Test case names must be unique</description>
      <keywords>catalog-self-test unique-testcase-names</keywords>
      <created by="Michael Kay" on="2012-11-07"/>
      <environment ref="catalog001"/>
      <dependencies>
         <spec value="XSLT20+"/>
      </dependencies>
      <test>
         <stylesheet file="catalog-003.xsl"/>
      </test>
      <result>
         <assert>not(/out/duplicate)</assert>
      </result>
   </test-case>
   
   <test-case name="catalog-004">
      <description>assert-xml must not be used where a test requests indent="yes"</description>
      <keywords>catalog-self-test assert-xml-usage-check</keywords>
      <created by="Michael Kay" on="2012-11-07"/>
      <modified by="Michael Kay" on="2012-12-11" change="add dependency on XML 1.1, see bug 20344"/>
      <environment ref="catalog001"/>
      <dependencies>
         <spec value="XSLT20+"/>
         <feature value="XML_1.1"/>        
      </dependencies>
      <test>
         <stylesheet file="catalog-004.xsl"/>
      </test>
      <result>
         <assert>not(/out/indenting)</assert>
      </result>
   </test-case>
   
   <test-case name="catalog-005">
      <description>Test that all non-error stylesheets are valid against the schema for stylesheets</description>
      <keywords>catalog-self-test tests-stylesheet-schema-validity xsl:import-schema</keywords>
      <created by="Michael Kay" on="2013-11-28"/>
      <environment ref="catalog005"/>
      <dependencies>
         <spec value="XSLT30+"/>
         <feature value="schema_aware"/>
      </dependencies>
      <test>
         <stylesheet file="catalog-005.xsl"/>
      </test>
      <result>
         <assert>not(/out/invalid)</assert>
      </result>
   </test-case>
   
   <test-case name="catalog-006">
      <description>Test that all XSLT element names in non-error stylesheets satisfy element-available()</description>
      <keywords>catalog-self-test element-available</keywords>
      <created by="Michael Kay" on="2015-06-30"/>
      <environment ref="catalog005"/>
      <dependencies>
         <spec value="XSLT30+"/>
         <feature value="schema_aware"/>
      </dependencies>
      <test>
         <stylesheet file="catalog-006.xsl"/>
      </test>
      <result>
         <assert>not(/out/unavailable)</assert>
      </result>
   </test-case>
</test-set>